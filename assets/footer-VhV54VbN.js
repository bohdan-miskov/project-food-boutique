import{a as i}from"./vendor-C7T_U3ZN.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const j=async()=>(await i.get("https://food-boutique.b.goit.study/api/products/discount")).data,R=async()=>(await i.get("https://food-boutique.b.goit.study/api/products/popular")).data,G=async t=>(await i.get("https://food-boutique.b.goit.study/api/products",{params:t})).data,A=async t=>(await i.get(`https://food-boutique.b.goit.study/api/products/${t}`)).data,U=async(t,e)=>await i.post("https://food-boutique.b.goit.study/api/orders",{email:e,products:t}),N=(t,e)=>{let r;return(...o)=>{clearTimeout(r),r=setTimeout(()=>t(...o),e)}},x=()=>{const t=document.querySelector(".cart-products-container");t&&t.classList.add("hidden");const e=document.querySelector(".order");e&&e.classList.add("hidden");const r=document.querySelector(".cart-products-empty-container");r&&r.classList.remove("hidden")},I=()=>{const t=document.querySelector(".cart-products-empty-container");t&&t.classList.add("hidden");const e=document.querySelector(".cart-products-container");e&&e.classList.remove("hidden");const r=document.querySelector(".order");r&&r.classList.remove("hidden")},v=async t=>{const e=document.querySelector(".cart-products-list");if(e.innerHTML="",t.length==0){x();return}I(),t.forEach(r=>e.appendChild(F(r)))},F=({_id:t,name:e,category:r,size:o,img:n,price:s,count:a})=>{const c=document.getElementById("cart-product-card-template").content.cloneNode(!0),f=c.querySelector(".cart-products-item-image");f.src=n,f.alt=e+" image";const L=c.querySelector(".cart-products-subtitle");L.textContent=e;const g=c.querySelectorAll(".cart-products-item-descr-item-value");g[0].textContent=r.split("_").join(" "),g[1].textContent=o;const w=c.querySelector(".cart-products-item-price");w.textContent="$"+s.toString(),c.querySelector(".cart-products-item-delete-btn").addEventListener("click",()=>k(t)),T(c);const y=c.querySelector(".cart-products-item-qty-input");if(!y)throw new Error("Quantity input is not found");const P=N(J,350);return y.addEventListener("change",O=>P(O,t)),y.value=a.toString(),c};function T(t){const e=t.querySelector(".cart-products-item-qty-container");if(!e)return;const r=e.querySelector(".cart-products-item-qty-input"),o=e.querySelector(".cart-products-item-qty-btn.increase"),n=e.querySelector(".cart-products-item-qty-btn.decrease");if(!r||!o||!n)return;const s=Number(r.min)||1,a=Number(r.max)||99;function u(c){n.disabled=c<=s,o.disabled=c>=a}o.addEventListener("click",()=>{let c=Number(r.value)||s;c<a&&(r.value=String(c+1),u(c+1),r.dispatchEvent(new Event("change")))}),n.addEventListener("click",()=>{let c=Number(r.value)||s;c>s&&(r.value=String(c-1),u(c-1),r.dispatchEvent(new Event("change")))}),r.addEventListener("input",()=>{let c=Number(r.value);isNaN(c)||c<s?(r.value=String(s),c=s):c>a&&(r.value=String(a),c=a),u(c)}),u(Number(r.value))}const C=t=>{const e=document.querySelector(".cart-product-count-value");e.textContent=t.toString()},l=t=>{const e=document.querySelector(".header-cart-info-value");e.textContent=t.toString()},q=t=>{const e=document.querySelector(".order-price-sum-value");if(!e)throw new Error("Order price element is not found");e.textContent="$"+t.toFixed(2)},E=t=>t.reduce((e,{price:r,count:o})=>e+r*o,0),d="cart",D=t=>({_id:t._id,name:t.name,category:t.category,size:t.size,is10PercentOff:t.is10PercentOff,price:t.price,img:t.img,count:1}),p=()=>{const t=localStorage.getItem(d);if(!t)return[];try{const e=JSON.parse(t);return Array.isArray(e)?e:[]}catch{return localStorage.removeItem(d),[]}},m=t=>{(!t||!Array.isArray(t))&&(t=[]);try{const e=JSON.stringify(t);localStorage.setItem(d,e)}catch{const e=JSON.stringify([]);localStorage.setItem(d,e)}},M=async t=>{const e=await A(t),r=D(e),o=p(),n=o.find(({_id:s})=>s===r._id);n?n.count++:(l(o.length+1),o.push(r)),m(o)},W=async(t,e)=>{t.stopPropagation(),await M(e)},_=async t=>{const r=p().filter(({_id:o})=>o!==t);if(r){l(r.length),C(r.length);const o=E(r);q(o),await v(r),m(r)}},k=async t=>{await _(t)},H=async()=>{l(0),C(0),await v([]),m([])},X=async()=>{await H()},z=(t,e)=>{const r=p();if(r.forEach(o=>{o._id===t&&(o.count=e)}),r){const o=E(r);q(o),m(r)}},J=(t,e)=>{const r=t.target;z(e,parseInt(r.value))},K=()=>{const t=p();l(t.length)};document.addEventListener("DOMContentLoaded",K);const h=document.querySelector(".header-scroll-btn");window.addEventListener("scroll",()=>{window.scrollY>300?h.classList.add("visible"):h.classList.remove("visible")});const b=t=>{t.classList.add("is-open");const e=t.querySelector(".modal-close-btn"),r=n=>{(n.target===t||n.target===e||e.contains(n.target))&&S(t,r,o)},o=n=>{n.key==="Escape"&&S(t,r,o)};t.addEventListener("click",r),document.addEventListener("keydown",o)},S=(t,e,r)=>{t.classList.remove("is-open"),t.removeEventListener("click",e),document.removeEventListener("keydown",r)},$=async t=>await i.post("https://food-boutique.b.goit.study/api/subscription",{email:t}),B=async t=>{var o;t.preventDefault();const e=t.target,r=new FormData(e);try{const n=await $(r.get("userEmail")),s=document.querySelector(".subscribing-thank-modal-backdrop");b(s)}catch(n){if(((o=n.response)==null?void 0:o.status)===409){const a=document.querySelector(".subscribing-error-modal-backdrop");b(a)}}finally{e.reset()}},Q=document.querySelector(".footer-form");Q.addEventListener("submit",B);export{G as a,R as b,j as c,p as d,E as e,X as f,A as g,W as h,U as i,b as o,v as p,q as s,C as u};
//# sourceMappingURL=footer-VhV54VbN.js.map
